<% if @valid %>
  $('#application-modal .modal-wrapper').html('<%= j render "application", applicant: @applicant, top_invitation: @top_invitation %>')
  $('#application-modal #first-name').focus()

  var initDate = moment().subtract(23, 'years')
  $("[data-datetimepicker]").datepicker({
    language: "es",
    format: "dd/mm/yyyy",
    orientation: 'bottom',
    defaultViewDate: { year: initDate.year() }
  });

  var country = window.country
  var currency = window.currency

  <% unless @applicant.persisted? %>
    $('#country').val(country.code)
  <% end %>
  $('#mobile-code').html('+' + $('#country option:selected').data('code'))
  $("#payment-method-fulltime option[value='scheme-1']").text("Esquema 1 - $0 " + currency + " de entrada + 17% de ingresos (3 años)")
  $("#payment-method-fulltime option[value='scheme-2']").text("Esquema 2 - " + country.scheme2Cost + " " + currency + " de entrada + 17% de ingresos (1 año y medio)")
  $("#payment-method-fulltime option[value='scheme-3']").text("Esquema 3 - " + country.scheme3Cost + " " + currency + " de entrada")
  $("#payment-method-partime option[value='scheme-1']").text("Esquema 1 - " + country.scheme4Installments + " pagos de " + country.scheme4InstallmentFee + " + 17% de ingresos (2 años)")
  $("#payment-method-partime option[value='scheme-2']").text("Esquema 2 - " + country.scheme5Installments + " pagos de " + country.scheme5InstallmentFee)
  $("#payment-method-partime option[value='scheme-3']").text("Esquema 3 - " + country.scheme5Cost + " " + currency + " de entrada")
<% else %>
  $("#token").parent('.form-group').addClass("has-error")
  $("#token").siblings('.help-block').html("Código inválido")
<% end %>